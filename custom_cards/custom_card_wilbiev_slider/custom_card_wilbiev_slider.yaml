---
### Custom Card Slider ###
custom_card_wilbiev_slider:
  template:
    - "icon_more_info_new"
    - "ulm_translation_engine"
  variables:
    ulm_custom_card_wilbiev_slider_name: "[[[ return entity.attributes.friendly_name ]]]"
    ulm_custom_card_wilbiev_slider_icon: "[[[ return entity.attributes.icon ]]]"
    ulm_custom_card_wilbiev_slider_enable_horizontal: false
    ulm_custom_card_wilbiev_slider_color: "blue"
    ulm_custom_card_wilbiev_slider_force_color: false
    ulm_custom_card_wilbiev_slider_force_background_color: false
    ulm_custom_card_wilbiev_slider_enable_collapse: false
    ulm_custom_card_wilbiev_slider_enable_slider: false
    ulm_custom_card_wilbiev_slider_slider_min: 0
    ulm_custom_card_wilbiev_slider_slider_max: 100
  show_icon: false
  show_name: false
  show_label: false
  state:
    - operator: "template"
      value: "[[[ return variables.ulm_active_state ]]]"
      styles:
        card:
          - background-color: >
              [[[
                  if (variables.ulm_custom_card_wilbiev_slider_color) {
                    if (variables.ulm_custom_card_wilbiev_slider_force_background_color) {
                      var color = variables.ulm_custom_card_wilbiev_slider_color;
                      return 'rgba(var(--color-' + color + '),var(--opacity-bg))';
                    }
                  }
              ]]]
  styles:
    grid:
      - grid-template-areas: >
          [[[
            if (variables.ulm_custom_card_wilbiev_slider_enable_collapse && entity.state != "on") {
              return "\"item1\"";
            }

            var areas = [];
            areas.push("item1");
            if (variables.ulm_custom_card_wilbiev_slider_enable_slider) {
              areas.push("item2");
            }

            if (variables.ulm_custom_card_wilbiev_slider_enable_horizontal) {
              return "\"" + areas.join(" ") + "\"";
            }
            return "\"" + areas.join("\" \"") + "\"";
          ]]]
      - grid-template-columns: >
          [[[
            if (variables.ulm_custom_card_wilbiev_slider_enable_collapse && entity.state != "on") {
              return "1fr";
            }
            if (variables.ulm_custom_card_wilbiev_slider_enable_horizontal) {
              return "1fr 1fr";
            }
            return "1fr";
          ]]]
      - grid-template-rows: >
          [[[
            if (variables.ulm_custom_card_wilbiev_slider_enable_horizontal || (variables.ulm_custom_card_wilbiev_slider_enable_collapse && entity.state != "on")) {
              return "min-content";
            }

            var rows = [];
            rows.push("min-content");
            if (variables.ulm_custom_card_wilbiev_slider_enable_slider) {
                rows.push("min-content");
            }
            return rows.join(" ");
          ]]]
      - row-gap: "12px"
    card:
      - border-radius: "var(--border-radius)"
      - box-shadow: "var(--box-shadow)"
      - padding: "12px"
    custom_fields:
      item2:
        - display: >
            [[[
                if (variables.ulm_custom_card_wilbiev_slider_enable_collapse && entity.state != "on") {
                    return "none";
                } else if (variables.ulm_custom_card_wilbiev_slider_enable_slider) {
                    return "block";
                } else {
                    return "none";
                }
            ]]]
  custom_fields:
    item1:
      card:
        type: "custom:button-card"
        custom_fields:
          item1:
            card:
              type: "custom:button-card"
              entity: "[[[ return entity.entity_id ]]]"
              icon: "[[[ return variables.ulm_custom_card_wilbiev_slider_icon ]]]"
              styles:
                icon:
                  - color: >
                      [[[
                          if(variables.ulm_custom_card_wilbiev_slider_force_color) {
                            if (variables.ulm_custom_card_wilbiev_slider_color) {
                              var color = variables.ulm_custom_card_wilbiev_slider_color;
                              return 'rgba(var(--color-' + color + '),1)';
                            }
                            return 'rgba(var(--color-theme),1)';
                          } else {
                            if (entity.state == "on") {
                              if (variables.ulm_custom_card_wilbiev_slider_color) {
                                var color = variables.ulm_custom_card_wilbiev_slider_color;
                                return 'rgba(var(--color-' + color + '),1)';
                              }
                              return 'rgba(var(--color-theme),1)';
                            }
                            return 'rgba(var(--color-theme),0.2)';
                          }
                      ]]]
                img_cell:
                  - background-color: >
                      [[[
                          if(variables.ulm_custom_card_wilbiev_slider_force_color) {
                            if (variables.ulm_custom_card_wilbiev_slider_color) {
                              var color = variables.ulm_custom_card_wilbiev_slider_color;
                              return 'rgba(var(--color-' + color + '),0.2)';
                            }
                            return 'rgba(var(--color-theme),0.05)';
                          } else {
                            if (entity.state == "on") {
                              if (variables.ulm_custom_card_wilbiev_slider_color) {
                                var color = variables.ulm_custom_card_wilbiev_slider_color;
                                return 'rgba(var(--color-' + color + '),0.2)';
                              }
                            }
                            return 'rgba(var(--color-theme),0.05)';
                          }
                      ]]]
              tap_action:
                action: >
                  [[[
                    if (entity.attributes.unit_of_measurement != null) {
                      return "more-info";
                    }
                  ]]]
          item2:
            card:
              type: "custom:button-card"
              entity: "[[[ return entity.entity_id ]]]"
              name: "[[[ return variables.ulm_custom_card_wilbiev_slider_name ]]]"
              label: >
                [[[
                  if (entity.attributes.unit_of_measurement != null) {
                    return entity.state + ' ' + entity.attributes.unit_of_measurement;
                  } else {
                    let wilbiev_entity_state = entity.state;
                    if (entity.state == 'on') wilbiev_entity_state = "Aan";
                    else if (entity.state == 'off') wilbiev_entity_state = "Uit";
                    else if (entity.state == 'available') wilbiev_entity_state = "Beschikbaar";
                    else if (entity.state == 'unavailable') wilbiev_entity_state = "Niet beschikbaar";
                    else if (entity.state == 'idle') wilbiev_entity_state = "Inactief";
                    else if (entity.state == 'open') wilbiev_entity_state = "Open";
                    else if (entity.state == 'closed') wilbiev_entity_state = "Gesloten";
                    return wilbiev_entity_state;
                  }
                ]]]
              state:
                - operator: "template"
                  value: "[[[ return variables.ulm_active_state ]]]"
                  styles:
                    name:
                      - color: >
                          [[[
                              if (variables.ulm_custom_card_wilbiev_slider_force_background_color) {
                                  return 'rgb(250,250,250)';
                              }
                          ]]]
                    label:
                      - color: >
                          [[[
                              if (variables.ulm_custom_card_wilbiev_slider_force_background_color) {
                                  return 'rgb(250,250,250)';
                              }
                          ]]]
    item2:
      card:
        type: "custom:button-card"
        template: "list_one_third_items"
        styles:
          card:
            - background: "none"
            - overflow: "visible"
          grid:
            - grid-template-areas: >
                [[[
                    return "'slider'";
                ]]]
            - grid-template-columns: >
                [[[
                    return "1fr";
                ]]]
          custom_fields:
            button:
              - display: >
                  [[[
                    return "none";
                  ]]]
        custom_fields:
          slider:
            card:
              type: "custom:my-slider"
              entity: "[[[ return entity.entity_id ]]]"
              radius: "14px"
              height: "42px"
              minSet: "[[[ return variables.ulm_custom_card_wilbiev_slider_slider_min ]]]"
              maxSet: "[[[ return variables.ulm_custom_card_wilbiev_slider_slider_max ]]]"
              mainSliderColor: >
                [[[
                  var color = variables.ulm_custom_card_wilbiev_slider_color;
                  if(variables.ulm_custom_card_wilbiev_slider_force_color) {
                    if (variables.ulm_custom_card_wilbiev_slider_force_background_color) {
                      return 'rgb(250,250,250)';
                    }
                    return 'rgba(var(--color-' + color + '),0.8)';
                  } else {
                    if (entity.state == "on") {
                      if (variables.ulm_custom_card_wilbiev_slider_force_background_color) {
                        return 'rgb(250,250,250)';
                      }
                      return 'rgba(var(--color-' + color + '),0.8)';
                    }
                    return "rgba(var(--color-grey),0.8)";
                  }
                ]]]
              secondarySliderColor: >
                [[[
                  var color = variables.ulm_custom_card_wilbiev_slider_color;
                  if(variables.ulm_custom_card_wilbiev_slider_force_color) {
                    if (variables.ulm_custom_card_wilbiev_slider_force_background_color) {
                      return 'rgba(var(--color-' + color + '),0.3)';
                    }
                    return 'rgba(var(--color-' + color + '),0.1)';
                  } else {
                    if (entity.state == "on") {
                      if (variables.ulm_custom_card_wilbiev_slider_force_background_color) {
                        return 'rgba(var(--color-' + color + '),0.3)';
                      }
                      return 'rgba(var(--color-' + color + '),0.1)';
                    }
                    return "rgba(var(--color-grey),0.1)";
                  }
                ]]]
              mainSliderColorOff: "rgba(var(--color-theme),0.05)"
              secondarySliderColorOff: "rgba(var(--color-theme),0.05)"
              thumbHorizontalPadding: "0px"
              thumbVerticalPadding: "0px"
              thumbWidth: "0px"
              card_mod:
              style: |
                ha-card {
                  border-radius: 14px;
                  box-shadow: none;
                }
