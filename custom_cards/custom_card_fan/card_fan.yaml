---
card_fan:
  template:
    - "icon_info_bg"
    - "yellow"
    - "ulm_language_variables"
  tap_action:
    action: "toggle"
  hold_action:
    action: "more-info"
  variables:
    ulm_card_fan_slider_temp_attribute: "temp"
    ulm_card_fan_slider_hum_attribute: "hum"
    always_show_attributes: true
  label: >-
    [[[
      if (entity.state !='unavailable'){
        if (entity.state == 'off'){
          if (variables.always_show_attributes == true){
            var temp = Math.round(entity.attributes[variables.ulm_card_fan_slider_temp_attribute]);
            var hum = Math.round(entity.attributes[variables.ulm_card_fan_slider_hum_attribute]);
            return variables.ulm_off + ' • ' + (temp ? temp : '0') + '°C' + ' • ' + (hum ? hum : '0') + '%';
          } else {
            return variables.ulm_off
          }

        } else if (entity.state == 'on'){
          if (entity.attributes.percentage != null){
            var per = entity.attributes.percentage;
            var temp = Math.round(entity.attributes[variables.ulm_card_fan_slider_temp_attribute]);
            var hum = Math.round(entity.attributes[variables.ulm_card_fan_slider_hum_attribute]);
            return (per ? per : '0') + '%' + ' • ' + (temp ? temp : '0') + '°C' + ' • ' + (hum ? hum : '0') + '%';
          } else {
            return variables.ulm_on
          }
        }
      } else {
        return variables.ulm_unavailable;
      }
    ]]]
